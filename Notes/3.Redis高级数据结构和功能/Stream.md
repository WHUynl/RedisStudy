# Stream

### Stream之前

1. 列表 

   • 优点：可以快速地将**新消息追加到列表的末尾**，并且**支持阻塞模式**；

   • 缺点：如果要查找包含指定数据的元素，或者进行范围查找，需要遍历整个列表；

2.  有序集合 

   • 优点：可以有效地进行范围查找，**适合实现延时队列**；

   • 缺点：**不支持阻塞模式**；

3.  发布订阅 

   • 优点： 可以将消息**发送给多个客户端，并且支持阻塞模式**；

   • 缺点：“**发送即忘**”的策略会导致离线的客户端丢失消息，所以无法实现可靠的消息队列。

### 简介

![](pic\4.png)

1. Stream是一个消息链表，它将所有加入的消息串接起来，**每个消息都有一个唯一的ID**； 
2. Stream中的**消息是持久化的**，Redis重启之后，消息不会丢失； 
3. Stream**可以挂接多个消费组**，每个消费组都有一个游标，用于**标识当前消费组的消费进度**； 
4. Stream中**消费组的状态是独立的，互相不受影响，即同一流内的消息会被多个消费组共享**； 
5. 消费组可以挂接多个消费者，这些**消费者之间是竞争关系**，任意**消费者处理了消息都会使游标向后移动**； 
6. 消费者内部有个**状态变量PEL**（Pending Entries List），它**记录了当前已经被客户端读取的消息**。