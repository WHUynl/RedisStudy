# 慢查询日志

### 简介

1. Redis提供了慢查询日志功能，帮助开发和运维人员定位系统存在的慢操作；
2. Redis会在命令执行前后计算它的执行时间，当超过预设阀值，就将这条命令的相关信息记录下来； 
3. Redis执行一条命令分为四步：发送命令、命令排队、**命令执行**、返回结果，**慢查询只统计第三步**。

### 慢查询配置参数

1. slowlog-log-slower-than 

   • 预设阀值，如果执行某条命令，它的执行时间超过了这个阀值，则它将被记录到慢查询日志中；

   • 单位是微秒，默认值是10000，若设置为零则记录所有命令，若设置为负数则不记录任何命令； 

2. . slowlog-max-len 

   • 指定慢查询日志最多存储多少条数据，默认值为128； 

   • Redis采用队列存储慢查询日志，该值就是队列的最大长度，当超出时最早插入的数据将从队头移除。

### 慢查询相关命令

1. slowlog get [n] 

   • 返回慢查询日志，可以**通过n指定返回的条目数**； 

   • 返回结果包含四个部分：**日志ID、发生时间戳、命令耗时、具体的命令及参数**； 

2. slowlog len 

   • 获取慢查询日志队列中，当前实际的条目数；

3. slowlog reset 

   • 重置慢查询日志。

**注意**

**慢查询日志是存储在内存中的**，为了防止数据丢失，**可以定期获取日志并持久化到其他存储中**！